<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Synths for Sale</title>
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <header>
      <h1>Synths for Sale</h1>
    </header>
    
    <section class="info-section">
      <p class="intro">Hi! This is where I sell the synths I don't use anymore</p>
      <p class="us-only">US only pls</p>
      
      <div class="shipping-info">
        <h3>Shipping</h3>
        <p>Synths will be shipped via USPS priority</p>
        <p>If you'd prefer another method or would like to add shipping insurance you can email me at <a href="mailto:faycarsons23@gmail.com">faycarsons23@gmail.com</a></p>
      </div>
    </section>

    <section class="products">
      {{ $checkoutLinks := .Site.Data.checkoutLinks }}
      {{ range .Site.Data.synths }}
      <article class="product">
        <div class="product-header">
          <h2>{{ .name }}</h2>
          <p class="brand">{{ .brand }}</p>
        </div>
        
        <p class="price">${{ .price }}</p>
        
        {{ if .note }}
        <p class="note">{{ .note }}</p>
        {{ end }}
        
        {{ if .images }}
        <div class="images">
          {{ range .images }}
          <img src="{{ (printf "images/%s" .) }}" >
          {{ end }}
        </div>
        {{ end }}
        
        <a href="{{ (index $checkoutLinks .name) }}" class="buy-btn">Buy Now</a>
      </article>
      {{ end }}
    </section>

    <!-- Enlarged image modal -->
    <div id="imageModal" class="modal">
      <span class="modal-close">&times;</span>
      <img class="modal-content" id="modalImage">
    </div>
    <script>
      const modal = document.getElementById('imageModal')
      const modalImg = document.getElementById('modalImage')
      const closeBtn = document.querySelector('.modal-close')

      document.querySelectorAll('.images img').forEach(img => {
        img.style.cursor = 'pointer'
        img.addEventListener('click', () => {
          modal.style.display = 'flex'
          modalImg.src = img.src
        })
        console.log(`adding handler for image ${img.src}`)
      })

      closeBtn.onclick = () => modal.style.display = 'none';
      modal.onclick = (e) => {
        if (e.target === modal) modal.style.display = 'none';
      };
      
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') modal.style.display = 'none';
      });
    </script>
  </body>
</html>
